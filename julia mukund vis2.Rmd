---
title: "juliua mukund vis2"
author: "JP"
date: "28/08/2021"
output: html_document
---

```{r setup, include=FALSE}

library(tidyverse)
library(dplyr)
library(readxl)
library(plotly)
library(janitor)
library(tidyverse)

```

<<<<<<< HEAD
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Attendance viz coloured by gender
```{R}

data = read_csv("pre_event_cleaned_dummy.csv")


data  %>% group_by(previous_attendance) %>% dplyr::count() %>% ggplot(aes(x = previous_attendance)) + geom_bar()
 


(data  %>% ggplot(aes(x = previous_attendance, fill = pronoun)) + geom_bar()+ggtitle('Previous Event Attendance by Gender')+ theme(plot.title=element_text(hjust=0.5)) + theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) ) %>% plotly::ggplotly()

```

## Find out event filled by attendance previously
```{r}

data  %>% group_by(find_out_event) %>% dplyr::count() %>% ggplot(aes(x = find_out_event, y=n)) + geom_bar(stat = "identity")
 

(data  %>% ggplot(aes(x = find_out_event, fill = previous_attendance)) + geom_bar()+ggtitle('Found Out About Event by Previous Attendance')+ theme(plot.title=element_text(hjust=0.5)) + theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) ) %>% plotly::ggplotly()
```
## Find out event alone
```{r}

data  %>% group_by(find_out_event) %>% dplyr::count() %>% ggplot(aes(x = find_out_event, y=n)) + geom_bar(stat = "identity")
 

data  %>% ggplot(aes(x = find_out_event)) + geom_bar(fill='skyblue1')+ggtitle('Found Out About Event by Previous Attendance')+ theme(plot.title=element_text(hjust=0.5)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))  
```
## Age alone
```{r}
glimpse(data)
data  %>% group_by(age_group) %>% dplyr::count() %>% ggplot(aes(x = age_group, y=n)) + geom_bar(stat = "identity")
 

data  %>% ggplot(aes(x = age_group)) + geom_bar(fill='skyblue1')+ggtitle('Age Group of Primary Participant')+ theme(plot.title=element_text(hjust=0.5)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))  
```
## Age 
```{r}
data2=select(data, -email, -pronoun, -previous_attendance, -find_out_event, -age_group)
glimpse(data2)

data2[is.na(data2)]  <- 0

glimpse(data2)

data2_agesums<- colSums(data2[3:9])
age_count<- c(data2_agesums)
age_df<- data.frame(age_count)

age_df %>% rownames_to_column("groups") %>% ggplot(aes(x = groups, y = age_count)) + geom_bar(stat = "identity", fill='skyblue1')+ggtitle('Age Group of All Participants at Event')+ theme(plot.title=element_text(hjust=0.5)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))  

```

```{r}


PreEventPlot <- function(data, varNames, title, yaxislabel, xaxislabel, legendlabel) {
  
  
  if(length(varNames) == 1) {
    # This line fixes it
    #data = data %>% dplyr::rename(var1 = varNames[[1]])
    if (varNames == "age_group"){
      # Mukund's Code
      data2=select(data, -email, -pronoun, -previous_attendance, -find_out_event, -age_group)
      glimpse(data2)
  
      data2[is.na(data2)]  <- 0

      glimpse(data2)

      data2_agesums<- colSums(data2[3:9])
      age_count<- c(data2_agesums)
      age_df<- data.frame(age_count)

age_df %>% rownames_to_column("groups") %>% ggplot(aes(x = groups, y = age_count)) + geom_bar(stat = "identity", fill='skyblue1')+ggtitle(title)+ theme(plot.title=element_text(hjust=0.5)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))  
    }else{
      data  %>% ggplot(aes(x = reorder(var1, var1, function(x)-length(x)))) + geom_bar()
    }
 
    
  } else {
    # This line fixes it
    data = data %>% dplyr::rename(var1 = varNames[[1]], var2 = varNames[[2]])

    data %>% ggplot(aes(x = reorder(var1, var1, function(x)-length(x)), fill = var2)) + 
      geom_bar() + labs(y= yaxislabel, x = xaxislabel)+labs(fill=legendlabel)+
      ggtitle(title) + 
        theme(plot.title=element_text(hjust=0.5)) +
        theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) 
    
  }
  
  
}


```


```{r}

data = read_csv("pre_event_cleaned_dummy.csv")
glimpse(data)
PreEventPlot(data, c("previous_attendance", "pronoun"), "Previous Event Attendance by Gender", "Number of Responses", "Previous Attendance Type", "Pronoun")
PreEventPlot(data, c("age_group"), "Age of All Participants at Event", "", "", "")

```


